<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>微前端 | loydLee&#39;s home</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.jpg">
    <meta name="description" content="我的小窝">
    
    <link rel="preload" href="/assets/css/0.styles.7fdd2b56.css" as="style"><link rel="preload" href="/assets/js/app.d5333c69.js" as="script"><link rel="preload" href="/assets/js/2.dd63acd8.js" as="script"><link rel="preload" href="/assets/js/36.90192c44.js" as="script"><link rel="prefetch" href="/assets/js/10.f5b7ad67.js"><link rel="prefetch" href="/assets/js/11.bd28fe7a.js"><link rel="prefetch" href="/assets/js/12.cf2c28fd.js"><link rel="prefetch" href="/assets/js/13.cb068762.js"><link rel="prefetch" href="/assets/js/14.70b647de.js"><link rel="prefetch" href="/assets/js/15.f5ea1c53.js"><link rel="prefetch" href="/assets/js/16.9089d3fe.js"><link rel="prefetch" href="/assets/js/17.85a5207c.js"><link rel="prefetch" href="/assets/js/18.5f2e36da.js"><link rel="prefetch" href="/assets/js/19.d07d7334.js"><link rel="prefetch" href="/assets/js/20.8ff14cc4.js"><link rel="prefetch" href="/assets/js/21.200ced88.js"><link rel="prefetch" href="/assets/js/22.2ce3e3af.js"><link rel="prefetch" href="/assets/js/23.91bc20a6.js"><link rel="prefetch" href="/assets/js/24.1e9eb40a.js"><link rel="prefetch" href="/assets/js/25.647a7f39.js"><link rel="prefetch" href="/assets/js/26.82c6a3f4.js"><link rel="prefetch" href="/assets/js/27.da5f1f45.js"><link rel="prefetch" href="/assets/js/28.08e1f84c.js"><link rel="prefetch" href="/assets/js/29.1565e245.js"><link rel="prefetch" href="/assets/js/3.e5358e6d.js"><link rel="prefetch" href="/assets/js/30.f09b64b0.js"><link rel="prefetch" href="/assets/js/31.f102bba4.js"><link rel="prefetch" href="/assets/js/32.5a104702.js"><link rel="prefetch" href="/assets/js/33.e08c1bc1.js"><link rel="prefetch" href="/assets/js/34.7575c096.js"><link rel="prefetch" href="/assets/js/35.47c13ef3.js"><link rel="prefetch" href="/assets/js/37.f82d892e.js"><link rel="prefetch" href="/assets/js/38.47359cb5.js"><link rel="prefetch" href="/assets/js/39.553e41b8.js"><link rel="prefetch" href="/assets/js/4.ee8516ba.js"><link rel="prefetch" href="/assets/js/40.8f62ea28.js"><link rel="prefetch" href="/assets/js/41.ebb4473c.js"><link rel="prefetch" href="/assets/js/42.86cff1a7.js"><link rel="prefetch" href="/assets/js/43.eeb871df.js"><link rel="prefetch" href="/assets/js/5.92ba487b.js"><link rel="prefetch" href="/assets/js/6.e4577d10.js"><link rel="prefetch" href="/assets/js/7.8f2c6af1.js"><link rel="prefetch" href="/assets/js/8.46fb09a3.js"><link rel="prefetch" href="/assets/js/9.1404eec2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7fdd2b56.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">loydLee's home</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/weber/electron/note.html" class="nav-link">
  前端er
</a></div><div class="nav-item"><a href="/other/note.html" class="nav-link">
  其他
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/weber/electron/note.html" class="nav-link">
  前端er
</a></div><div class="nav-item"><a href="/other/note.html" class="nav-link">
  其他
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>前端er</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>algorithm</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>css</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>electron</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>react</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>正则</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>其他</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/weber/other/note.html" class="sidebar-link">前端笔记</a></li><li><a href="/weber/other/基于飞冰的微前端实践.html" class="active sidebar-link">微前端</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/weber/other/基于飞冰的微前端实践.html#定义" class="sidebar-link">定义</a></li><li class="sidebar-sub-header"><a href="/weber/other/基于飞冰的微前端实践.html#优点" class="sidebar-link">优点</a></li><li class="sidebar-sub-header"><a href="/weber/other/基于飞冰的微前端实践.html#缺点" class="sidebar-link">缺点</a></li><li class="sidebar-sub-header"><a href="/weber/other/基于飞冰的微前端实践.html#微前端方案" class="sidebar-link">微前端方案</a></li><li class="sidebar-sub-header"><a href="/weber/other/基于飞冰的微前端实践.html#现有微前端方案" class="sidebar-link">现有微前端方案</a></li><li class="sidebar-sub-header"><a href="/weber/other/基于飞冰的微前端实践.html#基于-icestark-的项目实战" class="sidebar-link">基于 icestark 的项目实战</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/weber/other/基于飞冰的微前端实践.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/weber/other/基于飞冰的微前端实践.html#仿真系统接入示例" class="sidebar-link">仿真系统接入示例</a></li></ul></li></ul></li><li><a href="/weber/other/基于qiankun的微前端实践.html" class="sidebar-link">基于qiankun的微前端实践</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/other/note.html" class="sidebar-link">随记</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="微前端"><a href="#微前端" class="header-anchor">#</a> 微前端</h1> <h2 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h2> <blockquote><p>借鉴后端微服务的概念。就是将一个大型高度聚合的前端工程拆分成一个一个的小工程。每一个小工程具备独立的开发、运行能力。而整个系统由这些小工程协同合作，实现所有页面的展示与交互</p></blockquote> <p>一个图表：</p> <table><thead><tr><th style="text-align:left;">微服务</th> <th style="text-align:left;">微前端</th></tr></thead> <tbody><tr><td style="text-align:left;">一个微服务由一组接口构成，接口地址一般是 URL。当微服务收到一个接口的请求时，会进行路由找到相应的<code>逻辑</code>，输出<code>响应内容</code></td> <td style="text-align:left;">一个微前端由一组页面构成，页面地址也是 URL。当微前端收到一个页面 URL 的请求时，会进行路由找到相应的<code>组件</code>，渲染<code>页面内容</code>。</td></tr> <tr><td style="text-align:left;">后端微服务会有一个网关，作为单一入口接收所有的客户端接口请求，根据接口 URL 与服务的匹配关系，路由到对应的服务。</td> <td style="text-align:left;">微前端则会有一个加载器，作为单一入口接收所有页面 URL 的访问，根据页面 URL 与微前端的匹配关系，选择加载对应的微前端，由该微前端进行进行路由响应 URL。</td></tr></tbody></table> <h2 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h2> <ul><li>与时俱进，引入新技术</li> <li>局部/增量升级</li> <li>代码简洁、解耦、更易维护</li> <li>独立部署</li> <li>组织更具扩展能力，其团队更加独立自治，提高效率</li></ul> <h2 id="缺点"><a href="#缺点" class="header-anchor">#</a> 缺点</h2> <ul><li>重复依赖</li> <li>团队分裂（独立）更加明显</li> <li>操作复杂性</li></ul> <h2 id="微前端方案"><a href="#微前端方案" class="header-anchor">#</a> 微前端方案</h2> <blockquote><p>—— <a href="https://www.jianshu.com/p/785c2ca5a886" target="_blank" rel="noopener noreferrer">知乎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <table><thead><tr><th style="text-align:left;">方式</th> <th style="text-align:left;">开发成本</th> <th style="text-align:left;">维护成本</th> <th>可行性</th> <th>统一框架要求</th> <th>实现难度</th> <th>潜在风险</th></tr></thead> <tbody><tr><td style="text-align:left;">路由分发</td> <td style="text-align:left;">低</td> <td style="text-align:left;">低</td> <td>高</td> <td>否</td> <td>1</td> <td>方案普通</td></tr> <tr><td style="text-align:left;">iFrame</td> <td style="text-align:left;">低</td> <td style="text-align:left;">低</td> <td>高</td> <td>否</td> <td>1</td> <td>方案普通</td></tr> <tr><td style="text-align:left;">应用微服务化</td> <td style="text-align:left;">高</td> <td style="text-align:left;">低</td> <td>中</td> <td>否</td> <td>4</td> <td>需针对每个框架定制及 HOOK</td></tr> <tr><td style="text-align:left;">微件化</td> <td style="text-align:left;">高</td> <td style="text-align:left;">中</td> <td>低</td> <td>是</td> <td>5</td> <td>需针对构建系统，如 webpack 进行 hack</td></tr> <tr><td style="text-align:left;">微应用化</td> <td style="text-align:left;">中</td> <td style="text-align:left;">中</td> <td>高</td> <td>是</td> <td>3</td> <td>统一不同应用的构建规范</td></tr> <tr><td style="text-align:left;">纯 Web Components</td> <td style="text-align:left;">高</td> <td style="text-align:left;">低</td> <td>高</td> <td>否</td> <td>2</td> <td>新技术，浏览器的兼容问题</td></tr> <tr><td style="text-align:left;">结合 Web Components</td> <td style="text-align:left;">高</td> <td style="text-align:left;">低</td> <td>高</td> <td>否</td> <td>2</td> <td>新技术，浏览器的兼容问题</td></tr></tbody></table> <h2 id="现有微前端方案"><a href="#现有微前端方案" class="header-anchor">#</a> 现有微前端方案</h2> <ul><li>sing-spa</li> <li>qiankun</li> <li>icestark</li> <li>stencil</li> <li>。。。</li></ul> <h2 id="基于-icestark-的项目实战"><a href="#基于-icestark-的项目实战" class="header-anchor">#</a> 基于 icestark 的项目实战</h2> <blockquote><p>—— <a href="https://ice.work/docs/icestark/about" target="_blank" rel="noopener noreferrer">icestark 官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h3> <p>icestark 是一个面向大型系统的微前端解决方案，适用于以下业务场景：</p> <ul><li><p>后台比较分散，体验差别大，因为要频繁跳转导致操作效率低，希望能统一收口的一个系统内</p></li> <li><p>单页面应用非常庞大，多人协作成本高，开发/构建时间长，依赖升级回归成本高</p></li> <li><p>系统有二方/三方接入的需求</p></li></ul> <h3 id="仿真系统接入示例"><a href="#仿真系统接入示例" class="header-anchor">#</a> 仿真系统接入示例</h3> <ul><li><p>主框架：
1、AppRouter 配置-主要是一些公共组件注册（eg:NotFound、LoadingComponent）,生命周期方法
2、AppRoute 配置-配置子服务 title，path，basename,url---指定子服务地址，主要为 app.js 和 app.css
3、router 配置（主框架自身路由配置，多用于子服务切换）
4、代理-dev 环境下，需要将子服务用到的代理设置同步到主框架-<code>ice.config.js</code></p></li> <li><p>子服务：</p> <ul><li><p>vue:
1、main.js</p> <div class="language- extra-class"><pre><code>```js
...
import { getMountNode, registerAppLeave } from '@ice/stark-app'
...
const mountNode = getMountNode(document.getElementById('app')) // 获取节点

const vue = new Vue({
  router,
  store,
  render: h =&gt; h(App)
}).$mount()

mountNode.appendChild(vue.$el) // 挂载节点

registerAppLeave(() =&gt; {
  vue.$destroy() // 切换到其他服务注销实例
})
```
</code></pre></div><p>2、router(子服务需要定义基准路由)</p> <div class="language- extra-class"><pre><code>```js
...
import { getBasename } from '@ice/stark-app'

// 路由配置
const RouterConfig = {
  base: getBasename()
}
...
```
</code></pre></div><p>3、webpack 相关
本次实践中，遇到几个问题：</p> <ul><li><p>主框架中，我们对子服务的 app.js 以及 app.css 进行了引用，但是在实际开发中时，我们一般开启了文件 hash，这种情况下对资源的引用就成为了问题,因此，在 vue.config.js 中配置：</p> <div class="language- extra-class"><pre><code>```js
filenameHashing: false,
css: {
  extract: true
}
```
</code></pre></div></li> <li><p>生产环境下，子服务资源直接引用服务器地址，但是 dev 下，若开启了按需加载，publicPath 需定义为当前端口引用绝对地址，否则在主框架找不到按需加载的资源引起报错(包括且不限于路由中组件懒加载)
<code>publicPath: 'http://localhost:8082/'</code></p></li></ul></li></ul></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最近更新:</span> <span class="time">10/19/2021, 11:16:12 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/weber/other/note.html" class="prev">
        前端笔记
      </a></span> <span class="next"><a href="/weber/other/基于qiankun的微前端实践.html">
        基于qiankun的微前端实践
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div class="cat-container" data-v-a13867c0><canvas id="vuepress-cat" width="280" height="250" class="live2d" data-v-a13867c0></canvas></div></div></div>
    <script src="/assets/js/app.d5333c69.js" defer></script><script src="/assets/js/2.dd63acd8.js" defer></script><script src="/assets/js/36.90192c44.js" defer></script>
  </body>
</html>
