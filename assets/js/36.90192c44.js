(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{394:function(t,e,v){"use strict";v.r(e);var _=v(26),a=Object(_.a)({},(function(){var t=this,e=t.$createElement,v=t._self._c||e;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"微前端"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#微前端"}},[t._v("#")]),t._v(" 微前端")]),t._v(" "),v("h2",{attrs:{id:"定义"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#定义"}},[t._v("#")]),t._v(" 定义")]),t._v(" "),v("blockquote",[v("p",[t._v("借鉴后端微服务的概念。就是将一个大型高度聚合的前端工程拆分成一个一个的小工程。每一个小工程具备独立的开发、运行能力。而整个系统由这些小工程协同合作，实现所有页面的展示与交互")])]),t._v(" "),v("p",[t._v("一个图表：")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",{staticStyle:{"text-align":"left"}},[t._v("微服务")]),t._v(" "),v("th",{staticStyle:{"text-align":"left"}},[t._v("微前端")])])]),t._v(" "),v("tbody",[v("tr",[v("td",{staticStyle:{"text-align":"left"}},[t._v("一个微服务由一组接口构成，接口地址一般是 URL。当微服务收到一个接口的请求时，会进行路由找到相应的"),v("code",[t._v("逻辑")]),t._v("，输出"),v("code",[t._v("响应内容")])]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("一个微前端由一组页面构成，页面地址也是 URL。当微前端收到一个页面 URL 的请求时，会进行路由找到相应的"),v("code",[t._v("组件")]),t._v("，渲染"),v("code",[t._v("页面内容")]),t._v("。")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"left"}},[t._v("后端微服务会有一个网关，作为单一入口接收所有的客户端接口请求，根据接口 URL 与服务的匹配关系，路由到对应的服务。")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("微前端则会有一个加载器，作为单一入口接收所有页面 URL 的访问，根据页面 URL 与微前端的匹配关系，选择加载对应的微前端，由该微前端进行进行路由响应 URL。")])])])]),t._v(" "),v("h2",{attrs:{id:"优点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#优点"}},[t._v("#")]),t._v(" 优点")]),t._v(" "),v("ul",[v("li",[t._v("与时俱进，引入新技术")]),t._v(" "),v("li",[t._v("局部/增量升级")]),t._v(" "),v("li",[t._v("代码简洁、解耦、更易维护")]),t._v(" "),v("li",[t._v("独立部署")]),t._v(" "),v("li",[t._v("组织更具扩展能力，其团队更加独立自治，提高效率")])]),t._v(" "),v("h2",{attrs:{id:"缺点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#缺点"}},[t._v("#")]),t._v(" 缺点")]),t._v(" "),v("ul",[v("li",[t._v("重复依赖")]),t._v(" "),v("li",[t._v("团队分裂（独立）更加明显")]),t._v(" "),v("li",[t._v("操作复杂性")])]),t._v(" "),v("h2",{attrs:{id:"微前端方案"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#微前端方案"}},[t._v("#")]),t._v(" 微前端方案")]),t._v(" "),v("blockquote",[v("p",[t._v("—— "),v("a",{attrs:{href:"https://www.jianshu.com/p/785c2ca5a886",target:"_blank",rel:"noopener noreferrer"}},[t._v("知乎"),v("OutboundLink")],1)])]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",{staticStyle:{"text-align":"left"}},[t._v("方式")]),t._v(" "),v("th",{staticStyle:{"text-align":"left"}},[t._v("开发成本")]),t._v(" "),v("th",{staticStyle:{"text-align":"left"}},[t._v("维护成本")]),t._v(" "),v("th",[t._v("可行性")]),t._v(" "),v("th",[t._v("统一框架要求")]),t._v(" "),v("th",[t._v("实现难度")]),t._v(" "),v("th",[t._v("潜在风险")])])]),t._v(" "),v("tbody",[v("tr",[v("td",{staticStyle:{"text-align":"left"}},[t._v("路由分发")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("低")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("低")]),t._v(" "),v("td",[t._v("高")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("1")]),t._v(" "),v("td",[t._v("方案普通")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"left"}},[t._v("iFrame")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("低")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("低")]),t._v(" "),v("td",[t._v("高")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("1")]),t._v(" "),v("td",[t._v("方案普通")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"left"}},[t._v("应用微服务化")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("高")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("低")]),t._v(" "),v("td",[t._v("中")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("4")]),t._v(" "),v("td",[t._v("需针对每个框架定制及 HOOK")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"left"}},[t._v("微件化")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("高")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("中")]),t._v(" "),v("td",[t._v("低")]),t._v(" "),v("td",[t._v("是")]),t._v(" "),v("td",[t._v("5")]),t._v(" "),v("td",[t._v("需针对构建系统，如 webpack 进行 hack")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"left"}},[t._v("微应用化")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("中")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("中")]),t._v(" "),v("td",[t._v("高")]),t._v(" "),v("td",[t._v("是")]),t._v(" "),v("td",[t._v("3")]),t._v(" "),v("td",[t._v("统一不同应用的构建规范")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"left"}},[t._v("纯 Web Components")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("高")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("低")]),t._v(" "),v("td",[t._v("高")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("2")]),t._v(" "),v("td",[t._v("新技术，浏览器的兼容问题")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"left"}},[t._v("结合 Web Components")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("高")]),t._v(" "),v("td",{staticStyle:{"text-align":"left"}},[t._v("低")]),t._v(" "),v("td",[t._v("高")]),t._v(" "),v("td",[t._v("否")]),t._v(" "),v("td",[t._v("2")]),t._v(" "),v("td",[t._v("新技术，浏览器的兼容问题")])])])]),t._v(" "),v("h2",{attrs:{id:"现有微前端方案"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#现有微前端方案"}},[t._v("#")]),t._v(" 现有微前端方案")]),t._v(" "),v("ul",[v("li",[t._v("sing-spa")]),t._v(" "),v("li",[t._v("qiankun")]),t._v(" "),v("li",[t._v("icestark")]),t._v(" "),v("li",[t._v("stencil")]),t._v(" "),v("li",[t._v("。。。")])]),t._v(" "),v("h2",{attrs:{id:"基于-icestark-的项目实战"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#基于-icestark-的项目实战"}},[t._v("#")]),t._v(" 基于 icestark 的项目实战")]),t._v(" "),v("blockquote",[v("p",[t._v("—— "),v("a",{attrs:{href:"https://ice.work/docs/icestark/about",target:"_blank",rel:"noopener noreferrer"}},[t._v("icestark 官方文档"),v("OutboundLink")],1)])]),t._v(" "),v("h3",{attrs:{id:"简介"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),v("p",[t._v("icestark 是一个面向大型系统的微前端解决方案，适用于以下业务场景：")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("后台比较分散，体验差别大，因为要频繁跳转导致操作效率低，希望能统一收口的一个系统内")])]),t._v(" "),v("li",[v("p",[t._v("单页面应用非常庞大，多人协作成本高，开发/构建时间长，依赖升级回归成本高")])]),t._v(" "),v("li",[v("p",[t._v("系统有二方/三方接入的需求")])])]),t._v(" "),v("h3",{attrs:{id:"仿真系统接入示例"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#仿真系统接入示例"}},[t._v("#")]),t._v(" 仿真系统接入示例")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("主框架：\n1、AppRouter 配置-主要是一些公共组件注册（eg:NotFound、LoadingComponent）,生命周期方法\n2、AppRoute 配置-配置子服务 title，path，basename,url---指定子服务地址，主要为 app.js 和 app.css\n3、router 配置（主框架自身路由配置，多用于子服务切换）\n4、代理-dev 环境下，需要将子服务用到的代理设置同步到主框架-"),v("code",[t._v("ice.config.js")])])]),t._v(" "),v("li",[v("p",[t._v("子服务：")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("vue:\n1、main.js")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("```js\n...\nimport { getMountNode, registerAppLeave } from '@ice/stark-app'\n...\nconst mountNode = getMountNode(document.getElementById('app')) // 获取节点\n\nconst vue = new Vue({\n  router,\n  store,\n  render: h => h(App)\n}).$mount()\n\nmountNode.appendChild(vue.$el) // 挂载节点\n\nregisterAppLeave(() => {\n  vue.$destroy() // 切换到其他服务注销实例\n})\n```\n")])])]),v("p",[t._v("2、router(子服务需要定义基准路由)")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("```js\n...\nimport { getBasename } from '@ice/stark-app'\n\n// 路由配置\nconst RouterConfig = {\n  base: getBasename()\n}\n...\n```\n")])])]),v("p",[t._v("3、webpack 相关\n本次实践中，遇到几个问题：")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("主框架中，我们对子服务的 app.js 以及 app.css 进行了引用，但是在实际开发中时，我们一般开启了文件 hash，这种情况下对资源的引用就成为了问题,因此，在 vue.config.js 中配置：")]),t._v(" "),v("div",{staticClass:"language- extra-class"},[v("pre",[v("code",[t._v("```js\nfilenameHashing: false,\ncss: {\n  extract: true\n}\n```\n")])])])]),t._v(" "),v("li",[v("p",[t._v("生产环境下，子服务资源直接引用服务器地址，但是 dev 下，若开启了按需加载，publicPath 需定义为当前端口引用绝对地址，否则在主框架找不到按需加载的资源引起报错(包括且不限于路由中组件懒加载)\n"),v("code",[t._v("publicPath: 'http://localhost:8082/'")])])])])])])])])])}),[],!1,null,null,null);e.default=a.exports}}]);